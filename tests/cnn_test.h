#ifndef CNN_TEST_H 
#define CNN_TEST_H

#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include "cnn.h"

const int STRIDE = 2;
const int PADDING = 1;

double image[3 * 9 * 9] = {
4.069148692817690927e-02,-1.781981353024030684e-02,5.146638827509351227e-02,-2.378583792318417489e-01,-7.649415027365025210e-01,-1.508896490144386593e-01,-2.745078024982289810e-01,1.411650021504645469e+00,-5.912681843921728797e-01,-8.231968287575941456e-01,-1.601506948119759910e+00,-3.357286049002094607e-03,7.447727296976758282e-01,9.650545751195502842e-01,-9.411369241805483954e-01,-4.858392725096329912e-01,-8.900978865910227911e-02,-8.472785509752581712e-01,1.301427628926169699e+00,-3.494054930010138116e-01,-2.245385929135491843e+00,-2.876916974019846918e-02,-2.184396655061030756e+00,1.528451757073076012e-01,-2.067149772942314723e+00,-8.940883445741575342e-01,-6.159891564588662050e-01,2.076208125319215225e-01,-6.794711517077461904e-01,-7.237516521652342938e-01,-1.052709855684774848e-01,-1.579776235601190626e+00,-1.528595607575631010e-01,-5.798720280324829446e-01,7.698883865257213910e-02,6.098942524219563843e-01,-1.506436984071680918e+00,2.864763877531795178e-01,-1.783099254680585943e+00,1.459493805618374829e+00,5.301878144550796756e-01,-1.530217800908764969e-01,-3.778078918502235095e-01,-2.079296764492886584e+00,-1.710051324619417390e-01,1.492615982696219978e+00,2.520987276323779280e+00,2.180289937161653313e+00,-2.702633595620062557e-01,6.509276101625709465e-01,9.365312055751219278e-01,3.680874687142204338e-01,-3.478772200866197539e-01,1.902511383607930151e+00,3.579968848320486674e-01,4.152638991215195086e-01,-7.748664829222727812e-01,1.829544513377312775e-01,2.751688269982011104e-01,1.240033080735404525e+00,-1.091039128018380516e-01,-7.246545564613159074e-02,1.174912402863969474e+00,-8.475229798024043193e-01,-1.693773494188502537e+00,1.067445229880445545e+00,-3.593282149803961878e-01,1.557442416083570924e+00,-6.278583614187491779e-01,-7.172257564792721141e-01,2.732252446816730851e-01,5.854961118528192315e-02,-3.443987534919220050e-01,-9.688832510775208240e-01,-8.229892274083845660e-02,-1.369474176774575502e-01,-1.491372146030361057e+00,3.582667080158836170e-01,7.702426763394002451e-01,1.149850739046869297e-01,-4.960223160542007181e-01,-6.729217612107703250e-02,4.676750360370521276e-02,2.120070607412771313e+00,1.395580384442871802e+00,-1.643443252556250123e+00,1.158842027770504157e-01,1.067202411253248107e+00,1.206619588729046955e+00,2.654934397824482706e-01,9.111328722597581420e-01,-3.200883115854458172e-01,8.662793874723505594e-01,2.078950592795698160e+00,-9.435693090214724021e-01,-1.645852187697876223e+00,-2.346401122241557335e-01,-2.869758998885660328e-01,1.470636218110455529e+00,1.011989788931176637e+00,1.265690750287250310e+00,2.024216480588453271e-01,-8.419288321017558419e-01,7.911450008421361257e-01,6.370184358083336162e-02,-6.821655078429137431e-01,2.101622016023442507e-01,-7.495752153039673960e-02,-2.169875155532697608e+00,7.005239625751460419e-01,-6.052381234530744836e-01,6.372880700827153744e-01,-6.274855662188847383e-01,7.862856858313789221e-01,-1.553068775235470073e-02,-1.512694670133005737e+00,-1.178199233749228414e+00,1.766370699765105190e-01,-8.912036954718293158e-01,1.501426162029571021e+00,1.056576867111492124e+00,-1.875767419363470134e+00,-9.327496060910836495e-02,1.419057415574427772e+00,-3.177799791273666075e-01,1.699403243279066889e+00,-1.580670688528039491e+00,1.172844294527568276e-01,-8.707691283262148918e-01,-9.090792647976679852e-01,2.372677911068084844e-01,1.364111441560835969e+00,-1.860208751074960143e-01,-6.796297317531167781e-02,-1.092463664692771008e+00,1.394834565185243624e+00,-4.184321398459142638e-01,-1.357786330342972414e-01,7.226939014099817982e-01,2.807031794653303547e-01,-1.387284543341263054e+00,7.453411711702064846e-01,1.048675696188391404e-01,6.441470831426552301e-01,1.082985887874595987e-01,2.131335847414549622e+00,7.645294915957522308e-01,-3.657740361520079309e-01,8.109138912685261158e-02,4.770968921335762558e-01,7.608414747734022487e-01,-3.028446711863883381e-02,-1.115449112193000747e-01,-1.334441883431700893e+00,-6.948609626982957810e-01,-6.481870358761635531e-01,-4.735261284003445814e-01,4.520845356025065542e-01,-1.687808986693468016e+00,9.344464014524985623e-03,6.964068540968594290e-01,2.001039097136791511e+00,5.845309193826258021e-01,-2.682226798082634756e-01,2.546740789554458040e-01,5.714124169677763099e-02,2.729145121892749826e-01,1.108804324388203311e+00,-7.840845487352607890e-01,-2.251753593403452158e-01,1.138376254320793812e+00,-8.633825746149680069e-02,-3.799583683430063363e-01,-4.743898754121443351e-01,1.133559007052732936e-01,-3.697210677286544289e-01,-8.301845190326504476e-01,8.613773434435368914e-01,2.053655700847155652e-01,-6.268755778730910055e-01,-1.119070865422334693e+00,-6.992648728350277232e-02,-7.854756562753805182e-01,3.271965181246383469e-01,3.007764850975033766e-01,3.033854698658025595e-01,-1.133736834406370741e+00,1.421577346646017356e-02,-5.038335443551883452e-01,5.323258279834740536e-01,-8.925257799962053873e-03,-2.954581015677734679e-01,5.471745215918585314e-01,-1.307139907283318081e+00,-3.203561715166240997e-01,1.204547511853097275e+00,-5.795181111157717696e-02,-5.931057040497534905e-01,-1.014375065542385101e+00,-4.291215124401149272e-01,-1.621640944581446142e+00,-1.151743292922568163e+00,2.973791568928961238e-01,2.167271254840219818e-01,-1.435444317956899862e+00,-4.659121871966300649e-02,7.478201185348055668e-01,6.339881324240482785e-01,1.388985360845838235e+00,-8.844100380911007475e-02,-6.198210775305679210e-01,1.012288418520283173e+00,-7.660195270439389414e-01,-2.395497615108620693e+00,-7.463535294870773384e-01,8.115944681346783929e-01,1.287053560306003375e+00,1.097064565862408525e+00,4.817456523833767434e-01,-1.021453647096302042e+00,-9.951468783249579619e-01,-1.880724087236136821e+00,9.473346000472853135e-01,5.000409205107684274e-01,-3.705666574988296103e-01,7.516965889758049357e-01,-1.124253137086536070e+00,1.896577949559790977e+00,-4.047124796782584633e-01,1.122766969272796400e+00,6.257719022149660359e-02,-8.848325056220925910e-01,3.210662034998826853e-01,2.826759755716275468e-01,3.271930748062801264e-01,-1.522791626928036157e-01,-6.140385139151749438e-01,2.086456776143095659e+00,7.198438724901239094e-02,1.094810242822174429e+00,7.051241586124133987e-01,-2.803116952739175827e-01,-3.563567864746903235e-01
};

double kernel[5 * 3 * 3 * 3] = {
-2.075596271059251041e+00,2.320688879233211988e-01,1.028373194959030013e+00,-1.138112073696455617e+00,-6.783321400874859908e-01,-1.874130433327721557e+00,-9.284441444405718835e-01,-4.118752173069434308e-02,-1.291593558190673452e+00,1.517387715763181211e+00,2.924868094591938750e+00,5.353604950282494501e-01,1.800805890740069026e+00,5.904200530805094882e-01,-4.983882044138224776e-01,1.051448813056981429e-01,1.326935535206703376e+00,1.809743267620424367e+00,-3.300375593548566799e-01,-1.269517083530751878e+00,-3.553452442844498571e-01,7.515757173190820706e-02,-1.268596359384760008e+00,-1.420751835242733740e+00,-4.035222803724424767e-01,-6.048493447188258570e-02,-7.890179643936122700e-01,-8.000978465331066714e-01,7.450917484735225527e-01,-1.543421028942273177e+00,-6.940537009146663383e-01,1.650654729064235493e+00,5.589417055605490348e-02,-2.845142068015514281e-01,9.466538841927546466e-01,5.275434043913053150e-01,-3.961696441824087978e-01,-2.158459588969702594e-02,7.630604657676063329e-01,-3.263356343443859497e-01,1.447387071928773361e+00,1.233470174158076915e+00,4.222144638461913235e-01,-5.021838417190055415e-01,-1.513081238114334592e+00,7.477854981095167775e-01,2.624194370674325372e-01,-1.071675974980737633e+00,1.141919418773165162e+00,-2.385850316842043073e-01,-8.970728926517519408e-01,-1.914899143140996074e+00,1.007500759013340019e-01,2.682226674553522816e-01,3.384100054671647095e-01,-1.304989883206534862e-01,1.400986680724959577e+00,-4.048980904644715606e-01,1.039419396766681603e+00,1.160358724006204767e+00,-7.250932516752404966e-02,-4.988352428897244173e-02,-5.205496218132269481e-01,4.373906629199827978e-01,-3.425271574005878811e-02,-1.212225827343554441e+00,-3.409625571083265694e-01,1.683261521609240863e-01,5.946086415319016272e-01,9.484055023628520931e-02,-5.604756824819313588e-01,-1.082000012854078985e+00,1.740872615812300850e-01,1.272552681074129888e+00,-1.708712269032662823e-01,-9.122669607734513741e-01,6.914813183948589348e-01,6.757821025045069874e-01,3.063225245931677776e-01,6.044304397473312385e-01,-7.195589140907956427e-01,1.474669873473391513e-01,6.425798940122756653e-01,-8.620331110753264303e-01,1.190827298438229820e-01,-2.522502576411368436e-01,-2.331444795906133238e-01,-1.652740197634639530e-01,1.270602952838814914e-01,-2.350385261091285649e-01,-5.908640308654011797e-01,1.853350788767207935e-01,-4.876561257627483603e-01,2.935196884036208598e-01,3.751342470385109484e-01,2.330671716969066609e-01,1.748190173516678936e+00,-9.563431558054934570e-03,-9.323710440845014991e-02,4.296779504614388623e-01,-1.380143014724129591e+00,1.542445094063860545e+00,-1.108566978199979625e-01,1.446713039278661350e+00,2.493480406391615500e-01,5.064401091294016277e-01,-1.438737584648547951e+00,-1.626018465194757123e+00,-1.597636884656378209e+00,-7.205374080426850680e-01,2.410611291351634211e-01,-9.965389666237205457e-01,7.924748080839561296e-03,9.070355184162752771e-01,2.596273864169910683e-01,3.813238271078498581e-02,-1.169634828932310411e+00,8.182480810124747039e-01,-1.521507825140460124e-01,7.243486912809106171e-01,2.456440256957297952e-01,-3.748387738554527782e-01,2.014336071851328958e-02,8.863445967737934028e-01,1.534213309495458644e+00,7.351176933583247752e-01,-5.780093440621000278e-01,-1.078893138153619313e+00,1.338003312741719575e-01,-7.470989704601355141e-01,-3.070001548189747465e-01,-6.201064974841545840e-01,-9.936067248453325229e-01,1.596294544306590346e+00,-1.374620519078220360e+00
};

double image2[3 * 9 * 9] = {
1.764052345967664026e+00,4.001572083672232938e-01,9.787379841057392005e-01,2.240893199201457797e+00,1.867557990149967484e+00,-9.772778798764110153e-01,9.500884175255893682e-01,-1.513572082976978872e-01,-1.032188517935578448e-01,4.105985019383723289e-01,1.440435711608779867e-01,1.454273506962975082e+00,7.610377251469934157e-01,1.216750164928284139e-01,4.438632327454256621e-01,3.336743273742668325e-01,1.494079073157606130e+00,-2.051582637658008745e-01,3.130677016509013644e-01,-8.540957393017247767e-01,-2.552989815834078691e+00,6.536185954403606058e-01,8.644361988595057333e-01,-7.421650204064419443e-01,2.269754623987607633e+00,-1.454365674598764757e+00,4.575851730144606805e-02,-1.871838500258335980e-01,1.532779214358457542e+00,1.469358769900285022e+00,1.549474256969163022e-01,3.781625196021735635e-01,-8.877857476301127537e-01,-1.980796468223926965e+00,-3.479121493261526088e-01,1.563489691039800511e-01,1.230290680727720742e+00,1.202379848784411287e+00,-3.873268174079522730e-01,-3.023027505753355659e-01,-1.048552965067092613e+00,-1.420017937178975176e+00,-1.706270190625012617e+00,1.950775395231789666e+00,-5.096521817516534991e-01,-4.380743016111863786e-01,-1.252795360049926199e+00,7.774903558319100627e-01,-1.613897847557951515e+00,-2.127402802139687077e-01,-8.954665611936756253e-01,3.869024978592620068e-01,-5.108051375688730245e-01,-1.180632184122412109e+00,-2.818222833865486818e-02,4.283318705304176577e-01,6.651722238316788716e-02,3.024718977397813924e-01,-6.343220936809635946e-01,-3.627411659871381255e-01,-6.724604477759510424e-01,-3.595531615405412884e-01,-8.131462820444540496e-01,-1.726282602331676852e+00,1.774261422537528332e-01,-4.017809362082618851e-01,-1.630198346966044598e+00,4.627822555257741777e-01,-9.072983643832421841e-01,5.194539579613895175e-02,7.290905621775368717e-01,1.289829107574106681e-01,1.139400684543300679e+00,-1.234825820353652626e+00,4.023416411775490031e-01,-6.848100909403131986e-01,-8.707971491818817800e-01,-5.788496647644154613e-01,-3.115525321273726611e-01,5.616534222974543800e-02,-1.165149840783356483e+00,9.008264869541871001e-01,4.656624397304598428e-01,-1.536243686277223741e+00,1.488252193795599698e+00,1.895889176030583156e+00,1.178779571159650708e+00,-1.799248358123509139e-01,-1.070752621510542513e+00,1.054451726931136646e+00,-4.031769469731796285e-01,1.222445070382427446e+00,2.082749780768602954e-01,9.766390364837127525e-01,3.563663971744018832e-01,7.065731681919481533e-01,1.050002072082047849e-02,1.785870493905835188e+00,1.269120927036199165e-01,4.019893634447016528e-01,1.883150697056254375e+00,-1.347759061142446368e+00,-1.270484998485733596e+00,9.693967081580111556e-01,-1.173123405114159912e+00,1.943621185649292649e+00,-4.136189807597473456e-01,-7.474548114407577604e-01,1.922942026480384703e+00,1.480514791434424327e+00,1.867558960426569881e+00,9.060446582753852729e-01,-8.612256850547025389e-01,1.910064953099033680e+00,-2.680033709513803819e-01,8.024563957963951610e-01,9.472519677737479826e-01,-1.550100930908341890e-01,6.140793703460802888e-01,9.222066715665268033e-01,3.764255311556294337e-01,-1.099400790584194487e+00,2.982381742060559726e-01,1.326385896687030330e+00,-6.945678597313654778e-01,-1.496345403276707620e-01,-4.351535517216374438e-01,1.849263728479341840e+00,6.722947570124354622e-01,4.074618362411104311e-01,-7.699160744453164007e-01,5.392491912918172536e-01,-6.743326606573760706e-01,3.183055827435118251e-02,-6.358460783788809634e-01,6.764332949464997302e-01,5.765908166149409375e-01,-2.082987555779948763e-01,3.960067126616452771e-01,-1.093061508730505782e+00,-1.491257592705605539e+00,4.393917012645369158e-01,1.666734953725290402e-01,6.350314368921063934e-01,2.383144774863942050e+00,9.444794869904138412e-01,-9.128222254441585859e-01,1.117016288095852961e+00,-1.315907410511521158e+00,-4.615846048147089764e-01,-6.824160532463123541e-02,1.713342721649366629e+00,-7.447548220484399017e-01,-8.264385386590143989e-01,-9.845252442543230009e-02,-6.634782863621073723e-01,1.126635922106506982e+00,-1.079931508363423331e+00,-1.147468652411102408e+00,-4.378200447444340337e-01,-4.980324506923048955e-01,1.929532053816985782e+00,9.494208069257608074e-01,8.755124138519089494e-02,-1.225435518830167991e+00,8.443629764015471162e-01,-1.000215347389564746e+00,-1.544771096777611596e+00,1.188029792352301772e+00,3.169426119248496265e-01,9.208588237808189580e-01,3.187276529430211891e-01,8.568306119026911638e-01,-6.510255933001468653e-01,-1.034242841784464684e+00,6.815945182816269821e-01,-8.034096641738410760e-01,-6.895497777502005432e-01,-4.555325035173431458e-01,1.747915902505672858e-02,-3.539939112534839505e-01,-1.374951293418018805e+00,-6.436184028328905127e-01,-2.223403152224426638e+00,6.252314510271874681e-01,-1.602057655606747621e+00,-1.104383339428450572e+00,5.216507926097440490e-02,-7.395629963913132876e-01,1.543014595406735801e+00,-1.292856909723448577e+00,2.670508693491829288e-01,-3.928281822749560281e-02,-1.168093497741197417e+00,5.232766605317537012e-01,-1.715463312222481052e-01,7.717905512136673529e-01,8.235041539637314445e-01,2.163235949280689852e+00,1.336527949436391971e+00,-3.691818379424435803e-01,-2.393791775759263885e-01,1.099659595887113150e+00,6.552637307225978036e-01,6.401315260975920518e-01,-1.616956044310834395e+00,-2.432612439893563558e-02,-7.380309092056887010e-01,2.799245990432382425e-01,-9.815038964295794144e-02,9.101789080925919428e-01,3.172182151913020554e-01,7.863279621089761529e-01,-4.664190967359430617e-01,-9.444462559182503769e-01,-4.100496932025484709e-01,-1.702041386144059407e-02,3.791517355550818036e-01,2.259308950690852136e+00,-4.225715166064269307e-02,-9.559450004927769751e-01,-3.459817756993864291e-01,-4.635959746460941999e-01,4.814814737734621763e-01,-1.540797014444624802e+00,6.326199420033171150e-02,1.565065379653755862e-01,2.321810362002757755e-01,-5.973160689653627120e-01,-2.379217297360070038e-01,-1.424060908982531570e+00,-4.933198833621940671e-01,-5.428614760167177478e-01,4.160500462614254991e-01,-1.156182431821912715e+00,7.811981017099933755e-01,1.494484544491368805e+00,-2.069985025013532542e+00,4.262587307781009471e-01,6.769080350302455473e-01,-6.374370255522290307e-01,-3.972718143287976567e-01,-1.328805775869556227e-01
};

double kernel2[5 * 3 * 3 * 3] = {
-2.977908794017283256e-01,-3.090129690471222212e-01,-1.676003806329976697e+00,1.152331564783120044e+00,1.079618592036821090e+00,-8.133642592042028552e-01,-1.466424327802513972e+00,5.210648764527585630e-01,-5.757879698130661250e-01,1.419531633207796739e-01,-3.193284171450951892e-01,6.915387510701865859e-01,6.947491436560059297e-01,-7.255973784635842971e-01,-1.383363955395055411e+00,-1.582938397335081904e+00,6.103793791072051889e-01,-1.188859257784028900e+00,-5.068163542986875436e-01,-5.963140384505081215e-01,-5.256729626954628753e-02,-1.936279805846506941e+00,1.887785967938285514e-01,5.238910238342056047e-01,8.842208704466140989e-02,-3.108861716984717138e-01,9.740016626878340855e-02,3.990463456401301956e-01,-2.772592756426650151e+00,1.955912308250694176e+00,3.900933226879264581e-01,-6.524085823870200418e-01,-3.909533751876010932e-01,4.937417773491884487e-01,-1.161039390343665267e-01,-2.030684467781494362e+00,2.064492861359319420e+00,-1.105406572324726111e-01,1.020172711715799707e+00,-6.920498477843911589e-01,1.536377054245797735e+00,2.863436888922795687e-01,6.088438344754507625e-01,-1.045253366146954743e+00,1.211145289682700854e+00,6.898181645347883917e-01,1.301846229564998403e+00,-6.280875596415789186e-01,-4.810271184607877171e-01,2.303916697683941806e+00,-1.060015822721547263e+00,-1.359497006783208228e-01,1.136891362602695299e+00,9.772496771485560119e-02,5.829536797532935966e-01,-3.994490292628751771e-01,3.700558878475187496e-01,-1.306526851735316574e+00,1.658130679618188053e+00,-1.181640451285697613e-01,-6.801782039968503613e-01,6.663830820319143200e-01,-4.607197873885532924e-01,-1.334258471402753443e+00,-1.346717505797555336e+00,6.937731526901325108e-01,-1.595734381462668994e-01,-1.337015596684391627e-01,1.077743805976262736e+00,-1.126825808756743541e+00,-7.306777528648248365e-01,-3.848798091812754563e-01,9.435158931707400554e-02,-4.217145129057893460e-02,-2.868871923899076193e-01,-6.162640209564740346e-02,-1.073052762911746866e-01,-7.196043885517928729e-01,-8.129929885540773116e-01,2.745163577239395081e-01,-8.909150829955279072e-01,-1.157355259190853580e+00,-3.122922511256933098e-01,-1.576670161638158985e-01,2.256723497298209313e+00,-7.047002758562337377e-01,9.432607249694947571e-01,7.471883342046318210e-01,-1.188944955203736109e+00,7.732529774025996838e-01,-1.183880640193317735e+00,-2.659172237996740851e+00,6.063195243593807460e-01,-1.755890583437719421e+00,4.509344618059148435e-01,-6.840108977372165722e-01,1.659550796189872113e+00,1.068509399316009079e+00,-4.533858038513876587e-01,-6.878376110286823497e-01,-1.214077403094120600e+00,-4.409226322925913766e-01,-2.803554951845090848e-01,-3.646935443916853870e-01,1.567038552723639677e-01,5.785214977288783977e-01,3.496544569931739899e-01,-7.641439239064430344e-01,-1.437791473801578457e+00,1.364531848102471301e+00,-6.894491845499376437e-01,-6.522935999350191194e-01,-5.211893123011108742e-01,-1.843069550156648528e+00,-4.779740040404866774e-01,-4.796558140079476562e-01,6.203582983435125264e-01,6.984571491073360283e-01,3.770889086269340121e-03,9.318483741143036569e-01,3.399649838012619996e-01,-1.568211160255476855e-02,1.609281682982229844e-01,-1.906534935813993525e-01,-3.948495140334503106e-01,-2.677335368939664506e-01,-1.128011331470006873e+00,2.804417053162959750e-01,-9.931236109295806802e-01,8.416312640736364203e-01,-2.494585801609488507e-01,4.949498165009073858e-02,4.938367762809563466e-01,6.433144650629278871e-01,-1.570623408633452733e+00
};


void cnn_test();
void cnn_test_strided();

void cnn_test() {
	int c_out, h_out, w_out;

	//	Expects input size as [in_w, in_h, in_c]
	int input_size[3] = { 9,9,3 };
	//Expects kernel size as[k_w, k_h, k_input_channel, k_output_channel]
	int kernel_size[4] = { 3,3,3,5 };

	//cnn * cnn_init(int *input_size, int *kernel_size, double *input, double *kernel);
	cnn * layer = cnn_init(input_size, kernel_size, image, kernel, 1, 0);
	cnn_convolve(layer);

	for (c_out = 0; c_out < layer->output_c; c_out++) {
		printf("\nLayer");
		for (h_out = 0; h_out < layer->output_h; h_out++) {
			printf("\n");
			for (w_out = 0; w_out < layer->output_w; w_out++) {
				printf(" ** %.4f", *(layer->output + c_out * layer->output_h * layer->output_w + h_out * layer->output_w + w_out));
			}
		}
		printf("\nLayer end\n");
	}

	return;
}

void cnn_test_strided() {
	int c_out, h_out, w_out;

	//	Expects input size as [in_w, in_h, in_c]
	int input_size[3] = { 9,9,3 };
	//Expects kernel size as[k_w, k_h, k_input_channel, k_output_channel]
	int kernel_size[4] = { 3,3,3,5 };

	//cnn * cnn_init(int *input_size, int *kernel_size, double *input, double *kernel);
	cnn * layer = cnn_init(input_size, kernel_size, image2, kernel2, STRIDE, PADDING);
	cnn_convolve(layer);

	for (c_out = 0; c_out < layer->output_c; c_out++) {
		printf("\nLayer");
		for (h_out = 0; h_out < layer->output_h; h_out++) {
			printf("\n");
			for (w_out = 0; w_out < layer->output_w; w_out++) {
				printf(" ** %.4f", *(layer->output + c_out * layer->output_h * layer->output_w + h_out * layer->output_w + w_out));
			}
		}
		printf("\nLayer end\n");
	}

	return;
}


#endif 
